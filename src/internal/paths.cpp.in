/**
 *  \file RMF/paths.cpp
 *  \brief Handle read/write of Model data from/to files.
 *
 *  Copyright 2007-2012 IMP Inventors. All rights reserved.
 *
 */

#include <RMF/internal/paths.h>
#include <boost/filesystem/path.hpp>
#include <boost/filesystem/operations.hpp>
#include <stdexcept>

namespace RMF {
  namespace internal {
    std::string get_relative_path(std::string base,
                                  std::string file) {
      // assume it already is
      return file;
    }
    std::string get_absolute_path(std::string base,
                                  std::string file) {
#if BOOST_VERSION >= 104800
      return boost::filesystem::canonical(boost::filesystem::path(base)
                                          /boost::filesystem::path(file))
        .string();
#else
      return (boost::filesystem::path(base)/boost::filesystem::path(file))
        .string();
#endif
    }

    std::string get_data_path(std::string file) {
      boost::filesystem::path builddir("@CMAKE_SOURCE_DIR@");
      boost::filesystem::path installdir("@CMAKE_INSTALL_PREFIX@");

      boost::filesystem::path buildpath=builddir/"data"/file;
      if (boost::filesystem::exists(buildpath)) {
        return buildpath.string();
      }
      boost::filesystem::path installpath=installdir
        /"@CMAKE_INSTALL_DATADIR@"/"rmf"/file;
      if (boost::filesystem::exists(installpath)) {
        return installpath.string();
      }
      return std::string();
    }
  } // namespace internal
} /* namespace RMF */
